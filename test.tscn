[gd_scene load_steps=4 format=3 uid="uid://c4y7jykfqahit"]

[sub_resource type="Shader" id="Shader_wyywn"]
code = "shader_type canvas_item;

uniform vec2 cutout_spot = vec2(0.0);
uniform float cutout_size = 50;
uniform float amount = 40;
uniform sampler2D screen_tex : hint_screen_texture;


float sample_cutout(vec2 coord)
{
	float factor = smoothstep(0.2, 0.5, (distance(coord, cutout_spot) * cutout_size));
	if(factor <= 0.0){
		return 50000.0;
	}
	return round((factor * 8.0) + 1.0) * amount;
}


void fragment()
{
	vec2 grid_uv = round(SCREEN_UV * sample_cutout(SCREEN_UV)) / sample_cutout(SCREEN_UV);

	vec4 text = texture(screen_tex, grid_uv);

	COLOR = text;
}"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ftuq8"]
shader = SubResource("Shader_wyywn")
shader_parameter/cutout_spot = Vector2(0.185, 0.545)
shader_parameter/cutout_size = 1.3
shader_parameter/amount = 20.0

[sub_resource type="GDScript" id="GDScript_r2yxv"]
script/source = "extends ColorRect



# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta: float) -> void:
	var pos =  get_viewport().get_mouse_position() / get_viewport_rect().size
	(material as ShaderMaterial).set_shader_parameter(\"cutout_spot\", pos)
	pass
"

[node name="colorRect" type="ColorRect"]
material = SubResource("ShaderMaterial_ftuq8")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = SubResource("GDScript_r2yxv")
